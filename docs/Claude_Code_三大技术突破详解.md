# Claude Code ä¸‰å¤§æŠ€æœ¯çªç ´è¯¦è§£

> æ·±å…¥è§£æ Steeringã€SubAgents å’Œ Todos ç®¡ç†ç³»ç»Ÿ

## ç›®å½•

- [ä¸€ã€Steering (å®æ—¶è½¬å‘æœºåˆ¶)](#ä¸€steering-å®æ—¶è½¬å‘æœºåˆ¶)
  - [1.1 ä»€ä¹ˆæ˜¯ Steeringï¼Ÿ](#11-ä»€ä¹ˆæ˜¯-steering)
  - [1.2 æ ¸å¿ƒæœºåˆ¶](#12-æ ¸å¿ƒæœºåˆ¶)
  - [1.3 æŠ€æœ¯å®ç°](#13-æŠ€æœ¯å®ç°)
  - [1.4 ä¸ä¼ ç»Ÿæ¨¡å¼å¯¹æ¯”](#14-ä¸ä¼ ç»Ÿæ¨¡å¼å¯¹æ¯”)
- [äºŒã€SubAgents (å­ä»£ç†ç³»ç»Ÿ)](#äºŒsubagents-å­ä»£ç†ç³»ç»Ÿ)
  - [2.1 ä»€ä¹ˆæ˜¯ SubAgentsï¼Ÿ](#21-ä»€ä¹ˆæ˜¯-subagents)
  - [2.2 æ¶æ„æ¨¡å¼](#22-æ¶æ„æ¨¡å¼)
  - [2.3 å…³é”®ä¼˜åŠ¿](#23-å…³é”®ä¼˜åŠ¿)
  - [2.4 å®é™…åº”ç”¨](#24-å®é™…åº”ç”¨)
- [ä¸‰ã€Todos ç®¡ç†ç³»ç»Ÿ](#ä¸‰todos-ç®¡ç†ç³»ç»Ÿ)
  - [3.1 ä»€ä¹ˆæ˜¯ Todos ç®¡ç†ï¼Ÿ](#31-ä»€ä¹ˆæ˜¯-todos-ç®¡ç†)
  - [3.2 æ ¸å¿ƒç»„ä»¶](#32-æ ¸å¿ƒç»„ä»¶)
  - [3.3 æ™ºèƒ½æ’åºç®—æ³•](#33-æ™ºèƒ½æ’åºç®—æ³•)
  - [3.4 åŠ¨æ€æé†’æœºåˆ¶](#34-åŠ¨æ€æé†’æœºåˆ¶)
- [å››ã€ä¸‰å¤§æŠ€æœ¯ååŒå·¥ä½œ](#å››ä¸‰å¤§æŠ€æœ¯ååŒå·¥ä½œ)
- [äº”ã€å¯¹ Agentia Playground çš„å¯ç¤º](#äº”å¯¹-agentia-playground-çš„å¯ç¤º)

---

## ä¸€ã€Steering (å®æ—¶è½¬å‘æœºåˆ¶)

### 1.1 ä»€ä¹ˆæ˜¯ Steeringï¼Ÿ

**Steering æ˜¯ Claude Code æœ€é‡è¦çš„åˆ›æ–° - å®æ—¶ä¸­æ–­å’ŒåŠ¨æ€è°ƒæ•´ Agent çš„æ‰§è¡Œæµç¨‹ã€‚**

ç±»æ¯”ç†è§£ï¼š
- **ç±»ä¼¼ React Fiber** - å¯ä¸­æ–­çš„æ¸²æŸ“æœºåˆ¶
- **ç±»ä¼¼ Node.js Event Loop** - äº‹ä»¶é©±åŠ¨çš„å¼‚æ­¥å¤„ç†
- **ä¸“ä¸º AI Agent è®¾è®¡** - å¼‚æ­¥ç”Ÿæˆå™¨ + æ¶ˆæ¯é˜Ÿåˆ—

### 1.2 æ ¸å¿ƒæœºåˆ¶

#### æœºåˆ¶ 1ï¼šh2A å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—

```ascii
ä¼ ç»Ÿ Agent (âŒ)              Claude Code Steering (âœ…)

ç”¨æˆ·è¾“å…¥                     ç”¨æˆ·è¾“å…¥
   â†“                           â†“
åŒæ­¥å¤„ç†              â†’     h2A å¼‚æ­¥é˜Ÿåˆ— â† å¯ä»¥å®æ—¶ä¸­æ–­ï¼
æ— æ³•ä¸­æ–­                     å¯ä¸­æ–­å¯æ¢å¤
   â†“                           â†“
é¡ºåºæ‰§è¡Œ              â†’     nO ä¸»å¾ªç¯ â† åŠ¨æ€è°ƒåº¦ï¼
å›ºå®šæµç¨‹                     è‡ªé€‚åº”æµç¨‹
   â†“                           â†“
ç­‰å¾…ç»“æŸ              â†’     æµå¼è¾“å‡º â† å®æ—¶åé¦ˆï¼
å•ä¸€ç»“æœ                     æŒç»­äº¤äº’
```

#### ä¸ºä»€ä¹ˆé‡è¦ï¼Ÿ

**æ²¡æœ‰ Steeringï¼š**
- âŒ Agent å¯åŠ¨åæ— æ³•åœæ­¢ â†’ "ç³Ÿç³•ï¼Œå®ƒåœ¨åˆ é™¤é”™è¯¯çš„æ–‡ä»¶ï¼Œä½†æˆ‘åœä¸ä¸‹æ¥ï¼"
- âŒ æ— æ³•æ ¹æ®ä¸­é—´ç»“æœè°ƒæ•´ â†’ "å·²ç»å‘ç°é—®é¢˜äº†ï¼Œä½†è¿˜è¦ç­‰å®ƒæ‰§è¡Œå®Œ"
- âŒ ç”¨æˆ·ä½“éªŒå·® â†’ "åªèƒ½å¹²ç­‰ç€"

**æœ‰ Steeringï¼š**
- âœ… å®æ—¶ä¸­æ–­ï¼š"ä¸å¯¹ï¼Œåœï¼æˆ‘è¦æ”¹éœ€æ±‚"
- âœ… åŠ¨æ€è°ƒæ•´ï¼š"çœ‹åˆ°ç»“æœäº†ï¼Œæ¢ä¸ªæ–¹å‘è¯•è¯•"
- âœ… æµå¼åé¦ˆï¼š"è¾¹åšè¾¹çœ‹ï¼Œéšæ—¶è°ƒæ•´"

### 1.3 æŠ€æœ¯å®ç°

#### å®Œæ•´æ¶æ„

```ascii
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   Steering å®Œæ•´æœºåˆ¶                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç”¨æˆ·äº¤äº’å±‚
    â”‚
    â”‚ "åˆ†æç«å¯¹"
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  h2A æ¶ˆæ¯é˜Ÿåˆ—   â”‚ â† ç”¨æˆ·å¯ä»¥éšæ—¶æ’å…¥æ–°æ¶ˆæ¯
â”‚  [msg1, msg2]   â”‚ â† "åœæ­¢ï¼"ã€"æ¢ä¸ªæ–¹å‘"
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ å¼‚æ­¥æ¶ˆæ¯æµ
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              nO ä¸»å¾ªç¯ (async generator)                    â”‚
â”‚                                                             â”‚
â”‚  async function* mainLoop() {                               â”‚
â”‚    while (true) {                                           â”‚
â”‚      // ğŸ‘‰ æ£€æŸ¥ç‚¹ 1ï¼šæ˜¯å¦è¢«ä¸­æ–­ï¼Ÿ                          â”‚
â”‚      if (abortSignal.aborted) {                            â”‚
â”‚        yield { type: "interrupted" };                       â”‚
â”‚        break;                                               â”‚
â”‚      }                                                       â”‚
â”‚                                                             â”‚
â”‚      // ğŸ‘‰ æ£€æŸ¥ç‚¹ 2ï¼šæ‰§è¡Œä¸€å°æ­¥                            â”‚
â”‚      const message = await queue.dequeue();                â”‚
â”‚      yield { type: "processing", message };                â”‚
â”‚                                                             â”‚
â”‚      // ğŸ‘‰ æ£€æŸ¥ç‚¹ 3ï¼šè°ƒç”¨å·¥å…·                              â”‚
â”‚      if (message.type === "tool_call") {                   â”‚
â”‚        for await (const result of executeTool()) {         â”‚
â”‚          yield result; // æµå¼è¾“å‡º                         â”‚
â”‚          // æ¯æ¬¡ yield éƒ½æ˜¯ä¸€ä¸ªæš‚åœç‚¹ï¼Œå¯ä»¥è¢«ä¸­æ–­          â”‚
â”‚        }                                                    â”‚
â”‚      }                                                       â”‚
â”‚                                                             â”‚
â”‚      // ğŸ‘‰ æ£€æŸ¥ç‚¹ 4ï¼šæ£€æŸ¥æ–°æ¶ˆæ¯                            â”‚
â”‚      if (queue.hasNewMessage()) {                          â”‚
â”‚        // åŠ¨æ€è°ƒæ•´ï¼šä¼˜å…ˆå¤„ç†æ–°æ¶ˆæ¯                         â”‚
â”‚        continue;                                            â”‚
â”‚      }                                                       â”‚
â”‚    }                                                         â”‚
â”‚  }                                                           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ æµå¼è¾“å‡º
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   ç”¨æˆ·ç•Œé¢      â”‚ â† å®æ—¶çœ‹åˆ°æ¯ä¸€æ­¥
â”‚   å®æ—¶æ›´æ–°      â”‚ â† å¯ä»¥éšæ—¶ä¸­æ–­
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä»£ç ç¤ºä¾‹

```typescript
// Steering æ ¸å¿ƒï¼šå¼‚æ­¥ç”Ÿæˆå™¨
async function* agentSteering() {
  // ğŸ‘‰ å…³é”®ï¼šä½¿ç”¨ yield å¯ä»¥æš‚åœå’Œæ¢å¤

  yield { type: "thinking", message: "æ­£åœ¨åˆ†æ..." };

  // å¯ä»¥åœ¨è¿™é‡Œè¢«ä¸­æ–­ï¼
  const analysis = await analyzeCompetitors();

  yield { type: "result", data: analysis };

  // å¯ä»¥ç»§ç»­æ‰§è¡Œæ›´å¤šæ­¥éª¤
  const market = await analyzeMarket();

  yield { type: "result", data: market };
}

// ä½¿ç”¨
for await (const step of agentSteering()) {
  console.log(step); // æ¯ä¸€æ­¥éƒ½å¯ä»¥çœ‹åˆ°

  // ğŸ‘‰ å…³é”®ï¼šå¯ä»¥éšæ—¶åœæ­¢
  if (userSaysStop) {
    break; // ç«‹å³åœæ­¢ï¼
  }
}
```

```typescript
// h2A å¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—å®ç°
class SteeringQueue {
  private queue: Message[] = [];
  private abortController = new AbortController();

  // å¯ä»¥éšæ—¶æ·»åŠ æ–°æ¶ˆæ¯
  async enqueue(message) {
    this.queue.push(message);
    this.notify(); // å”¤é†’ Agent
  }

  // å¯ä»¥éšæ—¶ä¸­æ–­
  interrupt() {
    this.abortController.abort();
  }

  // Agent æŒç»­ç›‘å¬
  async *listen() {
    while (!this.abortController.signal.aborted) {
      if (this.queue.length > 0) {
        yield this.queue.shift(); // å–å‡ºä¸€ä¸ªæ¶ˆæ¯
      } else {
        await this.waitForMessage(); // ç­‰å¾…æ–°æ¶ˆæ¯
      }
    }
  }
}
```

### 1.4 ä¸ä¼ ç»Ÿæ¨¡å¼å¯¹æ¯”

#### ä¸‰ç§å¾ªç¯æœºåˆ¶å¯¹æ¯”

| ç‰¹æ€§ | React Fiber | Node Event Loop | Steering |
|------|------------|-----------------|----------|
| å¯ä¸­æ–­ | âœ… (æ—¶é—´ç‰‡) | âŒ | âœ… (éšæ—¶) |
| å¼‚æ­¥ | âœ… | âœ… | âœ… |
| æ¶ˆæ¯é©±åŠ¨ | âŒ | âœ… | âœ… |
| æµå¼è¾“å‡º | âŒ | âŒ | âœ… |
| åŠ¨æ€è°ƒæ•´ | âœ… (ä¼˜å…ˆçº§) | âŒ | âœ… (æ¶ˆæ¯é˜Ÿåˆ—) |
| ç”¨é€” | UI æ¸²æŸ“ | I/O å¤„ç† | AI Agent æ‰§è¡Œ |

#### å®é™…å¯¹æ¯”ï¼šåˆ†æ 5 ä¸ªç«å¯¹

**âŒ ä¼ ç»ŸåŒæ­¥æ–¹å¼**

```javascript
async function analyzeCompetitors() {
  // ä¸€æ—¦å¼€å§‹ï¼Œæ— æ³•åœæ­¢
  const c1 = await analyze("competitor1"); // 30ç§’
  const c2 = await analyze("competitor2"); // 30ç§’
  const c3 = await analyze("competitor3"); // 30ç§’
  const c4 = await analyze("competitor4"); // 30ç§’
  const c5 = await analyze("competitor5"); // 30ç§’

  // ç”¨æˆ·ç­‰äº† 150 ç§’æ‰çœ‹åˆ°ç»“æœ
  return [c1, c2, c3, c4, c5];
}

// é—®é¢˜ï¼š
// âŒ ç”¨æˆ·å‘ç°æ–¹å‘é”™äº†ï¼Œæ— æ³•ä¸­æ–­
// âŒ å¿…é¡»ç­‰æ‰€æœ‰åˆ†æå®Œæˆ
// âŒ ä¸­é—´çœ‹ä¸åˆ°è¿›åº¦
```

**âœ… Steering æ–¹å¼**

```javascript
async function* analyzeCompetitorsWithSteering(queue, abortSignal) {
  const competitors = ["c1", "c2", "c3", "c4", "c5"];

  for (const competitor of competitors) {
    // ğŸ‘‰ æ¯ä¸ªç«å¯¹åˆ†æå‰æ£€æŸ¥æ˜¯å¦ä¸­æ–­
    if (abortSignal.aborted) {
      yield { type: "interrupted", message: "ç”¨æˆ·å–æ¶ˆäº†" };
      break; // ç«‹å³åœæ­¢ï¼
    }

    // ğŸ‘‰ ç«‹å³æ˜¾ç¤ºè¿›åº¦
    yield {
      type: "progress",
      message: `æ­£åœ¨åˆ†æ ${competitor}...`,
      progress: competitors.indexOf(competitor) / competitors.length
    };

    // ğŸ‘‰ åˆ†æï¼ˆå¯ä»¥è¢«ä¸­æ–­ï¼‰
    const result = await analyze(competitor);

    // ğŸ‘‰ ç«‹å³è¾“å‡ºç»“æœï¼ˆä¸ç­‰å…¶ä»–ç«å¯¹ï¼‰
    yield {
      type: "result",
      competitor: competitor,
      data: result
    };

    // ğŸ‘‰ æ£€æŸ¥é˜Ÿåˆ—æ˜¯å¦æœ‰æ–°æ¶ˆæ¯
    if (queue.hasMessage()) {
      const newMessage = await queue.peek();

      // ç”¨æˆ·æ”¹å˜ä¸»æ„äº†
      if (newMessage.type === "change_direction") {
        yield { type: "direction_changed" };
        break;
      }
    }
  }
}

// ä¼˜åŠ¿ï¼š
// âœ… åˆ†æç¬¬ 1 ä¸ªåå°±èƒ½çœ‹åˆ°ç»“æœ
// âœ… å‘ç°ä¸å¯¹å¯ä»¥ç«‹å³åœæ­¢
// âœ… å¯ä»¥æ”¹å˜åˆ†ææ–¹å‘
// âœ… å®æ—¶è¿›åº¦æ˜¾ç¤º
```

#### å¯è§†åŒ–å¯¹æ¯”

```ascii
ä¼ ç»Ÿæ–¹å¼ï¼š
ç”¨æˆ·ç‚¹å‡» â”€â”€â†’ [ç­‰å¾…150ç§’...] â”€â”€â†’ çœ‹åˆ°ç»“æœ
           (é»‘ç›’ï¼Œæ— æ³•ä¸­æ–­)

Steering æ–¹å¼ï¼š
ç”¨æˆ·ç‚¹å‡» â”€â”€â†’ åˆ†æc1(30s) â”€â”€â†’ æ˜¾ç¤ºç»“æœ1 âœ“
                â†“
           åˆ†æc2(30s) â”€â”€â†’ æ˜¾ç¤ºç»“æœ2 âœ“
                â†“
           åˆ†æc3(15s) â”€â”€â†’ ç”¨æˆ·ç‚¹å‡»"åœæ­¢" âœ‹
                â†“
           [ç«‹å³åœæ­¢] â”€â”€â†’ è¿”å›å·²æœ‰ç»“æœ
```

---

## äºŒã€SubAgents (å­ä»£ç†ç³»ç»Ÿ)

### 2.1 ä»€ä¹ˆæ˜¯ SubAgentsï¼Ÿ

**SubAgents æ˜¯ä¸€ç§ä»»åŠ¡éš”ç¦»å’Œå¹¶å‘æ‰§è¡Œçš„æ¶æ„æ¨¡å¼ã€‚**

æ ¸å¿ƒæ€æƒ³ï¼š
- å°†å¤æ‚ä»»åŠ¡åˆ†è§£æˆå¤šä¸ªç‹¬ç«‹çš„å­ä»»åŠ¡
- æ¯ä¸ªå­ä»»åŠ¡ç”±ä¸€ä¸ªç‹¬ç«‹çš„ SubAgent æ‰§è¡Œ
- SubAgents ä¹‹é—´ç›¸äº’éš”ç¦»ï¼Œå¯ä»¥å¹¶å‘è¿è¡Œ

### 2.2 æ¶æ„æ¨¡å¼

```ascii
ä¸» Agent (nO å¾ªç¯)
    â”‚
    â”‚ é‡åˆ°å¤æ‚ä»»åŠ¡
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        Task å·¥å…·è°ƒç”¨                â”‚
â”‚   "å¸®æˆ‘åˆ†æè¿™ 5 ä¸ªç»„ä»¶çš„æ€§èƒ½"      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“ åˆ›å»º 5 ä¸ª SubAgents
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  SubAgent-1   SubAgent-2   SubAgent-3   â”‚
â”‚  åˆ†æç»„ä»¶A    åˆ†æç»„ä»¶B    åˆ†æç»„ä»¶C    â”‚
â”‚                                           â”‚
â”‚  SubAgent-4   SubAgent-5                 â”‚
â”‚  åˆ†æç»„ä»¶D    åˆ†æç»„ä»¶E                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚ ç‹¬ç«‹æ‰§è¡Œç¯å¢ƒ + éš”ç¦»æƒé™
    â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚        UH1 è°ƒåº¦å™¨å¹¶å‘æ§åˆ¶                â”‚
â”‚     æœ€å¤š 10 ä¸ª SubAgent åŒæ—¶è¿è¡Œ         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
    â”‚
    â†“ ç»“æœèšåˆ
è¿”å›ä¸» Agent
```

### 2.3 å…³é”®ä¼˜åŠ¿

#### 1. ä»»åŠ¡éš”ç¦»

```javascript
// æ¯ä¸ª SubAgent æœ‰ç‹¬ç«‹çš„æ‰§è¡Œç¯å¢ƒ
SubAgent1: {
  messages: [],      // ç‹¬ç«‹æ¶ˆæ¯å†å²
  tools: [subset],   // é™å®šçš„å·¥å…·é›†åˆ
  permissions: {},   // éš”ç¦»çš„æƒé™
}

// å¦‚æœ SubAgent-1 å¤±è´¥ï¼Œä¸å½±å“å…¶ä»– SubAgents
```

#### 2. å¹¶å‘æ‰§è¡Œ

```javascript
// æ–‡æ¡£ä¾‹å­ï¼šå¤§å‹é¡¹ç›®é‡æ„
è½®æ¬¡ 4-8: é—®é¢˜è¯Šæ–­é˜¶æ®µ
â”œâ”€ SubAgent-1: åˆ†æ App.js æ€§èƒ½ç“¶é¢ˆ
â”œâ”€ SubAgent-2: åˆ†æçŠ¶æ€ç®¡ç†ç»“æ„
â”œâ”€ SubAgent-3: æ£€æŸ¥é‡å¤ä»£ç æ¨¡å¼
â”œâ”€ SubAgent-4: Bundle size åˆ†æ
â””â”€ SubAgent-5: ä¾èµ–å…³ç³»æ¢³ç†

// 5 ä¸ªä»»åŠ¡å¹¶å‘æ‰§è¡Œï¼ŒèŠ‚çœ 80% æ—¶é—´ï¼
```

#### 3. ä¸“æ³¨æ€§

æ¯ä¸ª SubAgent åªå¤„ç†ä¸€ä¸ªæ˜ç¡®çš„å­ä»»åŠ¡ï¼Œä¸ä¼šè¢«å…¶ä»–ä¿¡æ¯å¹²æ‰°ã€‚

```typescript
// ä¸» Agentï¼šåè°ƒè€…
class MainAgent {
  async handleComplexTask(task: string) {
    // åˆ†è§£ä»»åŠ¡
    const subtasks = this.decompose(task);

    // åˆ›å»º SubAgents
    const subAgents = subtasks.map(t => new SubAgent(t));

    // å¹¶å‘æ‰§è¡Œ
    const results = await Promise.all(
      subAgents.map(agent => agent.execute())
    );

    // èšåˆç»“æœ
    return this.synthesize(results);
  }
}

// SubAgentï¼šæ‰§è¡Œè€…
class SubAgent {
  constructor(
    private task: string,
    private tools: Tool[],  // å—é™çš„å·¥å…·é›†
    private context: Context  // éš”ç¦»çš„ä¸Šä¸‹æ–‡
  ) {}

  async execute() {
    // ä¸“æ³¨æ‰§è¡Œå•ä¸ªä»»åŠ¡
    return await this.processTask(this.task);
  }
}
```

### 2.4 å®é™…åº”ç”¨

#### åœºæ™¯ï¼šå…¨æ ˆåº”ç”¨å¼€å‘

```ascii
å…¨æ ˆåº”ç”¨å¼€å‘åœºæ™¯å¤š Agent åä½œæµç¨‹

é˜¶æ®µä¸€: éœ€æ±‚åˆ†æä¸æ¶æ„è®¾è®¡ (è½®æ¬¡1-8)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ä¸»Agent Loop                        SubAgent Taskå¤„ç†      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚
â”‚ â”‚ nOä¸»å¾ªç¯    â”‚â”€â”€â”€ Taskå·¥å…·è°ƒç”¨ â”€â”€â–¶â”‚ I2Aå®ä¾‹åŒ–   â”‚         â”‚
â”‚ â”‚ â€¢ éœ€æ±‚è§£æ  â”‚                    â”‚ SubAgent    â”‚         â”‚
â”‚ â”‚ â€¢ æŠ€æœ¯é€‰å‹  â”‚                    â”‚ â€¢ æ•°æ®åº“è®¾è®¡â”‚         â”‚
â”‚ â”‚ â€¢ æ¶æ„è§„åˆ’  â”‚                    â”‚ â€¢ APIè®¾è®¡   â”‚         â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚ â€¢ å‰ç«¯æ¶æ„  â”‚         â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚ TodoçŠ¶æ€ç®¡ç†:                                               â”‚
â”‚ â”œâ”€ éœ€æ±‚åˆ†æ [completed]                                    â”‚
â”‚ â”œâ”€ æ•°æ®åº“è®¾è®¡ [in_progress]                                â”‚
â”‚ â”œâ”€ APIå¼€å‘ [pending]                                       â”‚
â”‚ â””â”€ å‰ç«¯å¼€å‘ [pending]                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€Todos ç®¡ç†ç³»ç»Ÿ

### 3.1 ä»€ä¹ˆæ˜¯ Todos ç®¡ç†ï¼Ÿ

**ä¸€ä¸ªåŠ¨æ€ä»»åŠ¡è·Ÿè¸ªç³»ç»Ÿï¼Œè®© Agent èƒ½ï¼š**
1. è®°ä½è¦åšä»€ä¹ˆ
2. çŸ¥é“åšåˆ°å“ªäº†
3. æé†’è‡ªå·±åˆ«å¿˜äº‹

### 3.2 æ ¸å¿ƒç»„ä»¶

```ascii
TodoWrite å·¥å…·                TodoRead å·¥å…·
    â”‚                             â”‚
    â†“                             â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â€¢ åˆ›å»ºä»»åŠ¡      â”‚       â”‚ â€¢ æŸ¥è¯¢ä»»åŠ¡      â”‚
â”‚ â€¢ æ›´æ–°çŠ¶æ€      â”‚       â”‚ â€¢ æ˜¾ç¤ºè¿›åº¦      â”‚
â”‚ â€¢ è®¾ç½®ä¼˜å…ˆçº§    â”‚       â”‚ â€¢ è¿½è¸ªå®Œæˆåº¦    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                         â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  YJ1 æ’åºç®—æ³•   â”‚
         â”‚  æ™ºèƒ½æ’åºä¼˜å…ˆçº§ â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### TodoWrite å·¥å…·

```typescript
interface Todo {
  content: string;           // ä»»åŠ¡å†…å®¹
  activeForm: string;        // è¿›è¡Œä¸­çš„æè¿°
  status: "pending" | "in_progress" | "completed";
  priority?: "high" | "medium" | "low";
  createdAt?: Date;
}

// ä½¿ç”¨ç¤ºä¾‹
await todoWrite.invoke({
  todos: [
    {
      content: "åˆ†æç«å¯¹",
      activeForm: "åˆ†æç«å¯¹ä¸­",
      status: "in_progress",
      priority: "high"
    },
    {
      content: "ä¼°ç®—å¸‚åœºè§„æ¨¡",
      activeForm: "ä¼°ç®—å¸‚åœºè§„æ¨¡ä¸­",
      status: "pending",
      priority: "medium"
    }
  ]
});
```

### 3.3 æ™ºèƒ½æ’åºç®—æ³•

#### YJ1 æ’åºç®—æ³•

```javascript
// ä»»åŠ¡çŠ¶æ€ä¼˜å…ˆçº§
const statusPriority = {
  in_progress: 0,  // æ­£åœ¨åšçš„ â†’ æœ€é«˜ä¼˜å…ˆçº§
  pending: 1,      // å¾…åšçš„ â†’ ä¸­ä¼˜å…ˆçº§
  completed: 2,    // å·²å®Œæˆ â†’ æœ€ä½ä¼˜å…ˆçº§
}

// é‡è¦æ€§çº§åˆ«æ˜ å°„
const importancePriority = {
  high: 0,    // é«˜é‡è¦æ€§
  medium: 1,  // ä¸­ç­‰é‡è¦æ€§
  low: 2,     // ä½é‡è¦æ€§
}

// æ’åºé€»è¾‘
function sortTodoItems(todoA, todoB) {
  // ç¬¬ä¸€å±‚ï¼šæŒ‰çŠ¶æ€ä¼˜å…ˆçº§
  const statusDiff = statusPriority[todoA.status] - statusPriority[todoB.status];
  if (statusDiff !== 0) return statusDiff;

  // ç¬¬äºŒå±‚ï¼šæŒ‰é‡è¦æ€§ä¼˜å…ˆçº§
  const importanceDiff = importancePriority[todoA.priority] - importancePriority[todoB.priority];
  if (importanceDiff !== 0) return importanceDiff;

  // ç¬¬ä¸‰å±‚ï¼šæŒ‰åˆ›å»ºæ—¶é—´
  return new Date(todoA.createdAt) - new Date(todoB.createdAt);
}
```

#### æ’åºæ•ˆæœ

```
æ’åºå‰:
1. [completed] éœ€æ±‚åˆ†æ
2. [pending] APIå¼€å‘
3. [in_progress] æ•°æ®åº“è®¾è®¡
4. [pending] å‰ç«¯å¼€å‘

æ’åºå (YJ1ç®—æ³•):
1. [in_progress] æ•°æ®åº“è®¾è®¡    â† æœ€é«˜ä¼˜å…ˆçº§ï¼šæ­£åœ¨è¿›è¡Œ
2. [pending] APIå¼€å‘           â† å¾…å¤„ç†ä»»åŠ¡
3. [pending] å‰ç«¯å¼€å‘
4. [completed] éœ€æ±‚åˆ†æ        â† å·²å®Œæˆï¼Œæœ€ä½ä¼˜å…ˆçº§
```

### 3.4 åŠ¨æ€æé†’æœºåˆ¶

**System-Reminder è‡ªåŠ¨æ³¨å…¥**

```ascii
Agent æ‰§è¡Œè¿‡ç¨‹
    â†“
çŠ¶æ€æ£€æµ‹è§¦å‘å™¨
â”œâ”€ Todo åˆ—è¡¨å˜åŒ–æ£€æµ‹
â”œâ”€ æ–‡ä»¶ç³»ç»ŸçŠ¶æ€å˜åŒ–
â””â”€ ç”¨æˆ·è¡Œä¸ºæ¨¡å¼åˆ†æ
    â†“
æ¡ä»¶åŒ¹é…å¼•æ“
    â†“
åŠ¨æ€æ³¨å…¥æé†’ï¼š
<system-reminder>
æ³¨æ„ï¼šTodoWrite å·¥å…·å¾ˆä¹…æ²¡ç”¨äº†ã€‚
å¦‚æœä½ åœ¨å¤„ç†å¤šæ­¥éª¤ä»»åŠ¡ï¼Œè€ƒè™‘ä½¿ç”¨ TodoWrite è·Ÿè¸ªè¿›åº¦ã€‚
</system-reminder>
```

#### å®é™…ä½¿ç”¨åœºæ™¯

```javascript
// ç¬¬ 1 è½®
User: "å¸®æˆ‘åšä¸€ä¸ªå…¨æ ˆåº”ç”¨"
Agent: [åˆ›å»º Todos]
  âœ“ éœ€æ±‚åˆ†æ [completed]
  âš¡ æ•°æ®åº“è®¾è®¡ [in_progress]
  â³ API å¼€å‘ [pending]
  â³ å‰ç«¯å¼€å‘ [pending]

// ç¬¬ 9 è½®
Agent: [æ›´æ–°çŠ¶æ€]
  âœ“ éœ€æ±‚åˆ†æ [completed]
  âœ“ æ•°æ®åº“è®¾è®¡ [completed]
  âš¡ API å¼€å‘ [in_progress]
  â³ å‰ç«¯å¼€å‘ [pending]

// ç¬¬ 18 è½®
<system-reminder>
æé†’ï¼šä½ æœ‰ 2 ä¸ªå¾…å¤„ç†ä»»åŠ¡ï¼ˆAPI å¼€å‘, å‰ç«¯å¼€å‘ï¼‰
å½“å‰è¿›åº¦ï¼š50% (2/4 å®Œæˆ)
</system-reminder>

// ç¬¬ 31 è½®
Agent: [å…¨éƒ¨å®Œæˆ]
  âœ“ éœ€æ±‚åˆ†æ [completed]
  âœ“ æ•°æ®åº“è®¾è®¡ [completed]
  âœ“ API å¼€å‘ [completed]
  âœ“ å‰ç«¯å¼€å‘ [completed]
```

---

## å››ã€ä¸‰å¤§æŠ€æœ¯ååŒå·¥ä½œ

### å®é™…æ¡ˆä¾‹ï¼šå¤§å‹é¡¹ç›®ä»£ç é‡æ„

```ascii
è½®æ¬¡ 1-3: é¡¹ç›®ç†è§£
User: "å¸®æˆ‘é‡æ„è¿™ä¸ª React é¡¹ç›®"

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Todos ç®¡ç† åˆ›å»ºä»»åŠ¡åˆ—è¡¨             â”‚
â”‚ âœ“ åˆ†æé¡¹ç›®ç»“æ„                      â”‚
â”‚ âš¡ æ€§èƒ½é—®é¢˜è¯Šæ–­                     â”‚
â”‚ â³ é‡æ„æ–¹æ¡ˆåˆ¶å®š                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è½®æ¬¡ 4-8: å¹¶å‘è¯Šæ–­
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SubAgents å¹¶å‘æ‰§è¡Œ                  â”‚
â”‚ SubAgent-1: åˆ†æ App.js            â”‚
â”‚ SubAgent-2: åˆ†æçŠ¶æ€ç®¡ç†            â”‚
â”‚ SubAgent-3: æ£€æŸ¥é‡å¤ä»£ç             â”‚
â”‚ SubAgent-4: Bundle size åˆ†æ       â”‚
â”‚ SubAgent-5: ä¾èµ–å…³ç³»æ¢³ç†            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“ 5 ä¸ªä»»åŠ¡åŒæ—¶æ‰§è¡Œ

è½®æ¬¡ 9-15: æ‰§è¡Œé‡æ„
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Steering å®æ—¶è°ƒæ•´                   â”‚
â”‚ User: "ç­‰ç­‰ï¼Œè¿™ä¸ªæ–¹æ¡ˆä¸å¯¹"          â”‚
â”‚ Agent: [ç«‹å³ä¸­æ–­] â†’ è°ƒæ•´æ–¹æ¡ˆ        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

<system-reminder>
æé†’ï¼šä½ çš„ Todo åˆ—è¡¨æœ‰ 8 ä¸ªå¾…å¤„ç†ä»»åŠ¡
å»ºè®®å…ˆå®Œæˆé«˜ä¼˜å…ˆçº§ä»»åŠ¡
</system-reminder>

è½®æ¬¡ 16-23: éªŒè¯ä¼˜åŒ–
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Todos ç®¡ç† æ ‡è®°å®Œæˆ                 â”‚
â”‚ âœ“ åˆ†æé¡¹ç›®ç»“æ„ [completed]         â”‚
â”‚ âœ“ æ€§èƒ½é—®é¢˜è¯Šæ–­ [completed]         â”‚
â”‚ âœ“ é‡æ„æ–¹æ¡ˆåˆ¶å®š [completed]         â”‚
â”‚ âœ“ ä»£ç é‡æ„æ‰§è¡Œ [completed]         â”‚
â”‚ âœ“ æµ‹è¯•éªŒè¯ [completed]             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ååŒå·¥ä½œæµç¨‹å›¾

```ascii
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ä¸‰å¤§æŠ€æœ¯ååŒæ¶æ„                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

                         ç”¨æˆ·è¯·æ±‚
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Todos ç®¡ç†   â”‚ â† åˆ›å»ºä»»åŠ¡åˆ—è¡¨
                    â”‚  è§„åˆ’ä»»åŠ¡     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Steering    â”‚ â† å®æ—¶è°ƒåº¦
                    â”‚  ä¸»å¾ªç¯æ§åˆ¶   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚           â”‚           â”‚
                â–¼           â–¼           â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚SubAgent-1â”‚ â”‚SubAgent-2â”‚ â”‚SubAgent-3â”‚ â† å¹¶å‘æ‰§è¡Œ
         â”‚  ä»»åŠ¡A   â”‚ â”‚  ä»»åŠ¡B   â”‚ â”‚  ä»»åŠ¡C   â”‚
         â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
               â”‚            â”‚            â”‚
               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚  Todos æ›´æ–°   â”‚ â† æ ‡è®°å®Œæˆ
                    â”‚  è¿½è¸ªè¿›åº¦     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                    <system-reminder>
                    åŠ¨æ€æé†’ Agent
                    </system-reminder>
```

---

## äº”ã€å¯¹ Agentia Playground çš„å¯ç¤º

### 5.1 å½“å‰å·²æœ‰åŠŸèƒ½

âœ… **ä¸Šä¸‹æ–‡ç®¡ç†** - ç±»ä¼¼ Todos çš„ç»“æ„åŒ–è®°å¿†
- `WorkingMemory` - è®°ä½åˆ›ä¸šæƒ³æ³•ã€åˆ†æç»“æœ
- `AnalysisCache` - ç¼“å­˜å·¥å…·ç»“æœ
- `MemoryManager` - é›†ä¸­ç®¡ç†ä¸Šä¸‹æ–‡

âœ… **åŸºç¡€ Agent** - å¯¹è¯æµç¨‹
- `ContextAwareAgent` - ä¸Šä¸‹æ–‡æ„ŸçŸ¥
- æ„å›¾æ£€æµ‹ - `detectUserIntent()`
- åŠ¨æ€ System Prompt

### 5.2 å¯ä»¥æ·»åŠ çš„åŠŸèƒ½

#### 1. Todos ç®¡ç†ç³»ç»Ÿ â­â­â­â­â­

**ä¼˜å…ˆçº§ï¼šæœ€é«˜**
**æ”¶ç›Šï¼šæœ€å¤§**
**éš¾åº¦ï¼šä¸­ç­‰**

```typescript
// æ·»åŠ åˆ° MemoryManager
class MemoryManager {
  private todos: Todo[] = [];

  // åˆ›å»ºä»»åŠ¡
  addTodo(content: string, priority: "high" | "medium" | "low" = "medium") {
    this.todos.push({
      content,
      activeForm: `${content}ä¸­`,
      status: "pending",
      priority,
      createdAt: new Date()
    });
  }

  // æ›´æ–°ä»»åŠ¡çŠ¶æ€
  updateTodoStatus(index: number, status: TodoStatus) {
    if (this.todos[index]) {
      this.todos[index].status = status;
    }
  }

  // YJ1 æ™ºèƒ½æ’åº
  sortTodos() {
    return this.todos.sort((a, b) => {
      const statusDiff = STATUS_PRIORITY[a.status] - STATUS_PRIORITY[b.status];
      if (statusDiff !== 0) return statusDiff;

      const priorityDiff = PRIORITY_MAP[a.priority] - PRIORITY_MAP[b.priority];
      return priorityDiff;
    });
  }

  // è·å–è¿›åº¦
  getProgress() {
    const completed = this.todos.filter(t => t.status === "completed").length;
    return {
      total: this.todos.length,
      completed,
      percentage: (completed / this.todos.length) * 100
    };
  }
}
```

#### 2. Steering å®Œå–„ â­â­â­

**ä¼˜å…ˆçº§ï¼šä¸­**
**æ”¶ç›Šï¼šæå‡ç”¨æˆ·ä½“éªŒ**
**éš¾åº¦ï¼šè¾ƒé«˜**

```typescript
// æ·»åŠ ä¸­æ–­æ§åˆ¶
class ContextAwareAgent {
  private abortController = new AbortController();

  async chat(message: string) {
    // æ£€æŸ¥ä¸­æ–­ä¿¡å·
    if (this.abortController.signal.aborted) {
      return "å·²ä¸­æ–­";
    }

    // æµå¼å¤„ç†
    for await (const step of this.processWithSteering(message)) {
      if (this.abortController.signal.aborted) {
        return "å·²ä¸­æ–­";
      }

      yield step; // æµå¼è¾“å‡º
    }
  }

  // ä¸­æ–­æ–¹æ³•
  interrupt() {
    this.abortController.abort();
  }

  // é‡ç½®
  reset() {
    this.abortController = new AbortController();
  }
}
```

#### 3. SubAgents æ”¯æŒ â­â­

**ä¼˜å…ˆçº§ï¼šä½**
**æ”¶ç›Šï¼šå¤„ç†å¤æ‚ä»»åŠ¡**
**éš¾åº¦ï¼šé«˜**

```typescript
// å½“ç”¨æˆ·è¦å®Œæ•´æŠ¥å‘Šæ—¶ï¼Œå¹¶å‘æ‰§è¡Œ
async generateVCReport(idea: string) {
  // åˆ›å»º 3 ä¸ª SubAgents å¹¶å‘åˆ†æ
  const subAgents = [
    this.createSubAgent("competitor"),
    this.createSubAgent("market"),
    this.createSubAgent("customer")
  ];

  // å¹¶å‘æ‰§è¡Œ
  const [competitor, market, customer] = await Promise.all([
    subAgents[0].analyze(idea),
    subAgents[1].analyze(idea),
    subAgents[2].analyze(idea)
  ]);

  // èšåˆç»“æœ
  return this.synthesize({ competitor, market, customer });
}

// åˆ›å»º SubAgent
createSubAgent(type: string) {
  return new ContextAwareAgent(
    this.tools.filter(t => t.category === type), // å—é™å·¥å…·é›†
    `subagent-${type}` // ç‹¬ç«‹ sessionId
  );
}
```

### 5.3 å®ç°ä¼˜å…ˆçº§å»ºè®®

| æŠ€æœ¯ | æ ¸å¿ƒä»·å€¼ | å½“å‰çŠ¶æ€ | ä¼˜å…ˆçº§ | éš¾åº¦ |
|------|---------|---------|-------|------|
| **Todos ç®¡ç†** | ä»»åŠ¡è·Ÿè¸ª+è¿›åº¦ç®¡ç† | âŒ æœªå®ç° | â­â­â­â­â­ | ä¸­ç­‰ |
| **Steering å®Œå–„** | å®æ—¶ä¸­æ–­+åŠ¨æ€è°ƒæ•´ | âš¡ éƒ¨åˆ†å®ç° | â­â­â­ | è¾ƒé«˜ |
| **SubAgents** | ä»»åŠ¡éš”ç¦»+å¹¶å‘æ‰§è¡Œ | âŒ æœªå®ç° | â­â­ | é«˜ |

### 5.4 å¿«é€Ÿå®ç°ï¼šTodos ç®¡ç†

```typescript
// 1. åˆ›å»º TodoWrite å·¥å…·
export const todoTool = createTool({
  name: "manage_todos",
  description: "ç®¡ç†ä»»åŠ¡åˆ—è¡¨ï¼Œè·Ÿè¸ªå¤šæ­¥éª¤ä»»åŠ¡çš„è¿›åº¦",
  schema: z.object({
    todos: z.array(z.object({
      content: z.string(),
      activeForm: z.string(),
      status: z.enum(["pending", "in_progress", "completed"]),
      priority: z.enum(["high", "medium", "low"]).optional()
    }))
  }),
  execute: async (input, context) => {
    // æ›´æ–°å†…å­˜ä¸­çš„ todos
    context.memory.updateTodos(input.todos);

    return {
      success: true,
      todos: context.memory.sortTodos(),
      progress: context.memory.getProgress()
    };
  }
});

// 2. åœ¨ System Prompt ä¸­æ³¨å…¥ Todo æé†’
const systemPrompt = `
You are a startup advisor.

CURRENT TODOS:
${memory.getTodos().map((t, i) =>
  `${i+1}. [${t.status}] ${t.content}`
).join('\n')}

Progress: ${memory.getProgress().percentage}%

IMPORTANT:
- Use the manage_todos tool to track multi-step tasks
- Update todo status as you complete each step
- Keep todos organized and up-to-date
`;
```

---

## æ€»ç»“

### ä¸‰å¤§æŠ€æœ¯çš„æœ¬è´¨

| æŠ€æœ¯ | æœ¬è´¨ | ç±»æ¯” | æ ¸å¿ƒä»·å€¼ |
|------|------|------|---------|
| **Steering** | å¼‚æ­¥ç”Ÿæˆå™¨ + æ¶ˆæ¯é˜Ÿåˆ— + å¯ä¸­æ–­æ§åˆ¶ | React Fiber + Node Event Loop | å®æ—¶å¯æ§ |
| **SubAgents** | ä»»åŠ¡éš”ç¦» + å¹¶å‘æ‰§è¡Œ + ç»“æœèšåˆ | å¾®æœåŠ¡æ¶æ„ | é«˜æ•ˆå¹¶å‘ |
| **Todos** | åŠ¨æ€ä»»åŠ¡è·Ÿè¸ª + æ™ºèƒ½æ’åº + è‡ªåŠ¨æé†’ | é¡¹ç›®ç®¡ç†å·¥å…· | ä¸ä¼šå¿˜äº‹ |

### ä¸ºä»€ä¹ˆè¿™ä¸‰ä¸ªæŠ€æœ¯æ˜¯çªç ´ï¼Ÿ

1. **Steering** - è§£å†³äº† AI Agent çš„**ä¸å¯æ§é—®é¢˜**
   - ä¼ ç»Ÿ Agentï¼šå¯åŠ¨åæ— æ³•åœæ­¢
   - Steeringï¼šéšæ—¶ä¸­æ–­ã€åŠ¨æ€è°ƒæ•´

2. **SubAgents** - è§£å†³äº† AI Agent çš„**æ•ˆç‡é—®é¢˜**
   - ä¼ ç»Ÿ Agentï¼šä¸²è¡Œæ‰§è¡Œ
   - SubAgentsï¼šå¹¶å‘å¤„ç†ã€èŠ‚çœ 80% æ—¶é—´

3. **Todos** - è§£å†³äº† AI Agent çš„**è®°å¿†é—®é¢˜**
   - ä¼ ç»Ÿ Agentï¼šå¿˜è®°è¦åšä»€ä¹ˆ
   - Todosï¼šå®Œæ•´è¿½è¸ªã€è‡ªåŠ¨æé†’

### å¯¹æœªæ¥ AI Agent çš„å½±å“

è¿™ä¸‰å¤§æŠ€æœ¯ä»£è¡¨äº† AI Agent ç³»ç»Ÿçš„å‘å±•æ–¹å‘ï¼š

1. **å¯æ§æ€§** (Steering) - Agent å¿…é¡»å¯æ§ï¼Œç”¨æˆ·è¦èƒ½éšæ—¶å¹²é¢„
2. **é«˜æ•ˆæ€§** (SubAgents) - Agent å¿…é¡»é«˜æ•ˆï¼Œèƒ½å¹¶å‘å¤„ç†å¤æ‚ä»»åŠ¡
3. **å¯é æ€§** (Todos) - Agent å¿…é¡»å¯é ï¼Œä¸èƒ½å¿˜è®°æ‰¿è¯º

**Claude Code çš„è¿™ä¸‰å¤§æŠ€æœ¯çªç ´ï¼Œä¸ºæ„å»ºä¸‹ä¸€ä»£ AI Agent ç³»ç»Ÿæä¾›äº†å®Œæ•´çš„æŠ€æœ¯å‚è€ƒã€‚**

---

## å‚è€ƒèµ„æ–™

- [Claude Code Agent ç³»ç»Ÿå®Œæ•´æŠ€æœ¯è§£æ](./Claude_Code_Agent.md)
- [Agentia Playground ä¸Šä¸‹æ–‡ç®¡ç†](../playground/docs/CONTEXT_MANAGEMENT.md)
- [React Fiber Architecture](https://github.com/acdlite/react-fiber-architecture)
- [Node.js Event Loop](https://nodejs.org/en/docs/guides/event-loop-timers-and-nexttick/)
